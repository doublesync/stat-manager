# Attribute dependent badges will live inside of this file.
attributeDependentBadges: any = {
    # Shooting badges
    "Agent 3": {4: {"3pt Shot": 98}},
    "Catch & Shoot": {4: {"3pt Shot": 95, "Midrange Shot": 95}},
    "Blinders": {4: {"3pt Shot": 96, "Midrange Shot": 96}},
    "Middy Magician": {4: {"Midrange Shot": 92}},
    "Space Creator": {4: {"3pt Shot": 95, "Midrange Shot": 95}},
    "Claymore": {4: {"3pt Shot": 93}},
    "Corner Specialist": {4: {"3pt Shot": 94}},
    "Deadeye": {4: {"3pt Shot": 98, "Midrange Shot": 98}},
    "Free Points": {4: {"Free Throw": 96}},
    "Open Looks": {4: {"3pt Shot": 93, "Midrange Shot": 93}},
    "Post Fade Phenom": {4: {"Post Fade": 95}},
    "Green Machine": {4: {"3pt Shot": 95, "Midrange Shot": 95}},
    "Spot Finder": {4: {"Acceleration": 95}},
    "Limitless Range": {4: {"3pt Shot": 99}},
    "Comeback Kid": {4: {"3pt Shot": 91, "Midrange Shot": 91}},
    "Guard Up": {4: {"3pt Shot": 93, "Midrange Shot": 93}},
    "Slippery Off-Ball": {4: {"Acceleration": 90}},
    # Finishing badges
    "Acrobat": {4: {"Driving Layup": 90}},
    "Aerial Wizard": {4: {"Driving Dunk": 95}},
    "Backdown Punisher": {4: {"Post Moves": 99}},
    "Big Driver": {4: {"Ball Control": 80}},
    "Bunny": {4: {"Driving Layup": 94, "Driving Dunk": 94}},
    "Bulldozer": {
        1: {
            "Strength": 75,
        },
        2: {
            "Strength": 83,
        },
        3: {
            "Strength": 90,
        },
        4: {
            "Strength": 95,
        },
    },
    "Bully": {
        1: {
            "Strength": 75,
        },
        2: {
            "Strength": 83,
        },
        3: {
            "Strength": 90,
        },
        4: {
            "Strength": 95,
        },
    },
    "Dream Shake": {4: {"Post Moves": 90}},
    "Fast Twitch": {4: {"Standing Dunk": 97, "Close Shot": 97}},
    "Fearless Finisher": {4: {"Driving Layup": 95}},
    "Float Game": {4: {"Driving Layup": 90}},
    "Giant Slayer": {4: {"Driving Layup": 90}},
    "Hook Specialist": {4: {"Post Hook": 99}},
    "Masher": {4: {"Close Shot": 95}},
    "Slithery Finisher": {4: {"Driving Layup": 95, "Driving Dunk": 95}},
    "Spin Cycle": {4: {"Driving Dunk": 85, "Driving Layup": 85}},
    "Whistle": {4: {"Draw Foul": 99}},
    # Playmaking badges
    "Ankle Breaker": {4: {"Ball Control": 94}},
    "Bail Out": {4: {"Pass Accuracy": 95}},
    "Blow-By": {"heightLimit": 83, 4: {"Ball Control": 96}},
    "Break Starter": {4: {"Pass Accuracy": 95}},
    "Dimer": {4: {"Pass Accuracy": 99}},
    "Hyperdrive": {4: {"Speed with Ball": 95}},
    "Killer Combos": {4: {"Ball Control": 98}},
    "Physical Handles": {4: {"Ball Control": 90}},
    "Post Playmaker": {4: {"Passing Vision": 95}},
    "Relay Passer": {4: {"Pass Accuracy": 90}},
    "Speed Booster": {"heightLimit": 83, 4: {"Ball Control": 99}},
    "Touch Passer": {4: {"Pass Accuracy": 95}},
    "Triple Spike": {4: {"Ball Control": 92}},
    "Unpluckable": {"heightLimit": 84, 4: {"Ball Control": 90}},
    # Defensive badges
    "94 Feet": {4: {"Perimeter Defense": 90}},
    "Anchor": {4: {"Strength": 99}},
    "Ankle Brace": {4: {"Perimeter Defense": 94}},
    "Boxout Beast": {4: {"Defensive Rebound": 95, "Offensive Rebound": 95}},
    "Brick Wall": {
        1: {
            "Strength": 60,
        },
        2: {
            "Strength": 75,
        },
        3: {
            "Strength": 85,
        },
        4: {
            "Strength": 90,
        },
    },
    "Challenger": {4: {"Perimeter Defense": 95}},
    "Fast Feet": {4: {"Perimeter Defense": 92}},
    "Glove": {4: {"Steal": 99}},
    "Interceptor": {4: {"Steal": 90}},
    "Immovable Enforcer": {3: {"Strength": 90}, 4: {"Strength": 9999}},
    "Off-Ball Pest": {4: {"Perimeter Defense": 90}},
    "Pick Dodger": {4: {"Perimeter Defense": 95}},
    "Pogo Stick": {4: {"Block": 97}},
    "Rebound Chaser": {4: {"Defensive Rebound": 99, "Offensive Rebound": 99}},
    "Work Horse": {4: {"Hustle": 90}},
}

attributeDependentBadges2: any = {
    "Posterizer": {
        1: {
            "Driving Dunk": 75,
            "Vertical": 70,
        },
        2: {
            "Driving Dunk": 86,
            "Vertical": 75,
        },
        3: {
            "Driving Dunk": 93,
            "Vertical": 80,
        },
        4: {
            "Driving Dunk": 99,
            "Vertical": 83,
        },
    },
    "Clamps": {
        "heightLimit": 82,
        "overHeightMax": 1,
        1: {
            "Perimeter Defense": 75,
            "Strength": 45,
        },
        2: {
            "Perimeter Defense": 85,
            "Strength": 50,
        },
        3: {
            "Perimeter Defense": 93,
            "Strength": 55,
        },
        4: {
            "Perimeter Defense": 99,
            "Strength": 60,
        },
    },
    "Chase Down Artist": {
        1: {
            "Vertical": 65,
            "Block": 77,
        },
        2: {
            "Vertical": 75,
            "Block": 77,
        },
        3: {
            "Vertical": 84,
            "Block": 85,
        },
        4: {
            "Vertical": 90,
            "Block": 95,
        },
    },
}

badgeCategories: dict[str, list[str]] = {
    "Shooting": [
        "Agent 3",
        "Blinders",
        "Catch & Shoot",
        "Claymore",
        "Comeback Kid",
        "Corner Specialist",
        "Deadeye",
        "Free Points",
        "Green Machine",
        "Guard Up",
        "Limitless Range",
        "Middy Magician",
        "Open Looks",
        "Post Fade Phenom",
        "Slippery Off-Ball",
        "Space Creator",
        "Spot Finder",
    ],
    "Playmaking": [
        "Ankle Breaker",
        "Bail Out",
        "Blow-By",
        "Break Starter",
        "Dimer",
        "Handles for Days",
        "Hyperdrive",
        "Killer Combos",
        "Needle Threader",
        "Physical Handles",
        "Post Playmaker",
        "Relay Passer",
        "Special Delivery",
        "Speed Booster",
        "Touch Passer",
        "Triple Spike",
        "Unpluckable",
    ],
    "Finishing": [
        "Acrobat",
        "Aerial Wizard",
        "Backdown Punisher",
        "Big Driver",
        "Bulldozer",
        "Bunny",
        "Dream Shake",
        "Dropstepper",
        "Fast Twitch",
        "Fearless Finisher",
        "Float Game",
        "Giant Slayer",
        "Hook Specialist",
        "Masher",
        "Post Spin Technician",
        "Posterizer",
        "Precision Dunker",
        "Pro Touch",
        "Rise Up",
        "Scooper",
        "Slithery",
        "Spin Cycle",
        "Two Step",
        "Whistle",
    ],
    "Defensive": [
        "94 Feet",
        "Anchor",
        "Ankle Braces",
        "Boxout Beast",
        "Brick Wall",
        "Challenger",
        "Chase Down Artist",
        "Clamps",
        "Fast Feet",
        "Glove",
        "Interceptor",
        "Immovable Enforcer",
        "Off-Ball Pest",
        "Pick Dodger",
        "Pogo Stick",
        "Post Lockdown",
        "Rebound Chaser",
        "Right Stick Ripper",
        "Work Horse",
    ],
}

badgePrices: dict[int, int] = {
    1: 4,
    2: 6,
    3: 12,
    4: 25,
}


def checkBadgePrice(startLevel: int, endLevel: int) -> int:
    cost: int = 0
    for i in range(startLevel + 1, endLevel + 1):
        cost += badgePrices[i]
    return cost


def checkEligibility(player: any, badge: str, badgeTier: int) -> any:
    if badge in attributeDependentBadges:
        # Check if the badgeTier is in the dictionary
        if not badgeTier in attributeDependentBadges[badge]:
            return [True, True]
        # Check if the player is too tall for the badge (1st dictionary)
        if "heightLimit" in attributeDependentBadges[badge]:
            if player.height > attributeDependentBadges[badge]["heightLimit"]:
                # Check if players above the height limit are allowed to have the badge
                if not "overHeightMax" in attributeDependentBadges[badge]:
                    return [False, "Player is too tall for this badge"]
                elif badgeTier > attributeDependentBadges[badge]["overHeightMax"]:
                    # fmt: off
                    return [False, f"Player is too tall for this badge (max tier: {attributeDependentBadges[badge]['overHeightMax']})"]
                    # fmt: on
        # These badges require only one attribute to be met
        if badgeTier in attributeDependentBadges[badge]:
            for attribute, value in attributeDependentBadges[badge][badgeTier].items():
                # Player only has to meet one requirement
                if player.attributes[attribute] < value:
                    continue
                else:
                    return [True, True]
            # If the player meets no requirements
            return [False, f"{badge} requires {attribute} to be at least {value}"]
    elif badge in attributeDependentBadges2:
        # Check if the badgeTier is in the dictionary
        if not badgeTier in attributeDependentBadges2[badge]:
            return [True, True]
        # Check if the player is too tall for the badge (2nd dictionary)
        if "heightLimit" in attributeDependentBadges2[badge]:
            if player.height > attributeDependentBadges2[badge]["heightLimit"]:
                # Check if players above the height limit are allowed to have the badge
                if not "overHeightMax" in attributeDependentBadges2[badge]:
                    return [False, "Player is too tall for this badge"]
                elif badgeTier > attributeDependentBadges2[badge]["overHeightMax"]:
                    # fmt: off
                    return [False, f"Player is too tall for this badge (max tier: {attributeDependentBadges2[badge]['overHeightMax']})"]
                    # fmt: on
        # These badges require all attributes to be met
        if badgeTier in attributeDependentBadges2[badge]:
            for attribute, value in attributeDependentBadges2[badge][badgeTier].items():
                # Player only has to meet both requirements
                if player.attributes[attribute] < value:
                    # fmt: off
                    return [False, f"Requires {attribute} to be at least {value}"]
                    # fmt: on
            return [True, True]
    else:
        return [True, True]


# class MockPlayer:
#    def __init__(self, attributes, height):
#        self.attributes = attributes
#        self.height = height
# player = MockPlayer(height=83, attributes={"Strength": 40, "Offensive Rebound": 40, "Defensive Rebound": 40})
# print(f"Response: {checkEligibility(player, "Boxout Beast", 1)}")
